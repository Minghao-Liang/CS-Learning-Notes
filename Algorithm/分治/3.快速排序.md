# 快速排序

快速排序也是使用分治的策略，其做法和归并排序刚好是互补的。快速排序的思想是当两个子数组有序时数组自动就有序了，和归并排序的区别在于归并排序是先递归调用排序，再进行归并，而快速排序是先确定切分的元素，使得元素左边的数组和元素右边的数组这两个数组之间的关系是有序的，即切分元素左边的数都小于切分元素，右边的数都大于切分元素，然后对子数组进行递归排序。

事实上，切分元素的选择会影响到快速排序的性能，这里我们以选择中间元素为例，用代码描述快速排序的算法：

```c++
quick_sort(int q[], int l, int r)
{
    if(l >= r) return;
    
    int i = l - 1, j = r + 1;
    int x = q[l + r >> 1]; // 选择中间元素作为切分元素
    
    while(i < j)
    {
        do i++; while(q[i] < x);
        do j--; while(q[j] > x);
        if(i < j) swap(q[i], q[j]);
    }
    
    quick_sort(q, l, j);
    quick_sort(q, j + 1, r);
}
```

这里还要注意对于中间元素作为切分元素的情况，也有不同的情况，在此如果选择$(l+r+1)/2$作为切分元素，对于排序子数组的选择要做出调整，避免出现溢出问题：

```c++
	quick_sort(q, l, i - 1);
    quick_sort(q, i, r);
```

当快速排序每次都能将数组对半分，就能得到最好的情况，此时的成本跟归并排序是一样的。